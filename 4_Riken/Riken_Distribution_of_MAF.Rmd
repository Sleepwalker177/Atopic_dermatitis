---
title: "Riken Distribution of MAF"
author: "Zichong Liu"
date: "2024-07-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(data.table)
library(ggplot2)
```

```{r}
# Importing data using the fread function of the data.table package
Riken <- fread("Riken_rsID.tsv")
```

```{r}
head(Riken)
```

### Derive the top 100 SNPs with the smallest MAFs

```{r}
Riken_sorted <- Riken[order(Riken$AF_Allele2, decreasing = F), ]
head(Riken_sorted, 20)
```

```{r}
Riken_head_MAF <- head(Riken_sorted, 100)
write.xlsx(Riken_head_MAF, "Riken_head_MAF.xlsx")
```

### Plot the histogram of the MAF distribution

```{r}
Riken_p <- ggplot(Riken, aes(x = AF_Allele2)) +
  geom_histogram(binwidth = 0.0001, fill = "#5B79FB", color = "#5B79FB", alpha = 1.0) +
  labs(title = "Histogram of MAF distribution for Riken", x = "MAF", y = "Frequency of MAF") +
  theme_minimal()
ggsave("Histogram of MAF distribution for Riken.png", Riken_p, width = 10, height = 8)
```
